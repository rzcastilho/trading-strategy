# Advanced Multi-Indicator Strategy Example
# Combines multiple technical indicators for high-confidence signals
#
# Strategy Logic:
# - Trend: MACD and EMA alignment
# - Momentum: RSI and Stochastic confirmation
# - Volatility: Bollinger Bands for entry/exit timing
# - Volume: OBV for trend strength validation
#
# Entry requires ALL conditions to align (high selectivity, high win rate)

strategy_id: "multi-indicator-advanced-v2"
name: "Multi-Indicator Confluence Strategy"
description: "Advanced strategy combining MACD, RSI, Stochastic, Bollinger Bands, and volume analysis"
trading_pair: "BTC/USD"
timeframe: "4h"  # 4-hour candles for swing trading
version: "2.0.0"

# Technical Indicators
indicators:
  # Trend Indicators
  - type: "macd"
    name: "macd_12_26_9"
    parameters:
      short_period: 12
      long_period: 26
      signal_period: 9

  - type: "ema"
    name: "ema_20"
    parameters:
      period: 20

  - type: "ema"
    name: "ema_50"
    parameters:
      period: 50

  # Momentum Indicators
  - type: "rsi"
    name: "rsi_14"
    parameters:
      period: 14

  - type: "stochastic"
    name: "stoch_14_3_3"
    parameters:
      k_period: 14
      d_period: 3
      smooth: 3

  # Volatility Indicator
  - type: "bb"
    name: "bollinger_20"
    parameters:
      period: 20
      std_dev: 2.0

  # Volume Indicator
  - type: "obv"
    name: "obv"
    parameters: {}

  # Additional Confirmation
  - type: "atr"
    name: "atr_14"
    parameters:
      period: 14

# Entry Conditions (ALL must be true)
# 1. MACD bullish crossover (MACD line > signal line)
# 2. Price above both EMAs (EMA_20 > EMA_50, uptrend confirmed)
# 3. RSI between 40-60 (not overbought, room to run)
# 4. Stochastic %K > %D and %K > 20 (bullish momentum)
# 5. Price near lower Bollinger Band (value entry)
# 6. OBV trending up (volume confirms trend)
entry_conditions: |
  macd_12_26_9_macd > macd_12_26_9_signal AND
  macd_12_26_9_macd[1] <= macd_12_26_9_signal[1] AND
  ema_20 > ema_50 AND
  close > ema_20 AND
  rsi_14 > 40 AND rsi_14 < 60 AND
  stoch_14_3_3_k > stoch_14_3_3_d AND stoch_14_3_3_k > 20 AND
  close < bollinger_20_middle AND close > bollinger_20_lower AND
  obv > obv[5]

# Exit Conditions (ANY can trigger)
# 1. MACD bearish crossover
# 2. RSI overbought (> 75)
# 3. Stochastic overbought (%K > 80 and crossover down)
# 4. Price touches upper Bollinger Band (take profit)
# 5. Price crosses below EMA_20 (trend weakening)
exit_conditions: |
  (macd_12_26_9_macd < macd_12_26_9_signal AND macd_12_26_9_macd[1] >= macd_12_26_9_signal[1]) OR
  rsi_14 > 75 OR
  (stoch_14_3_3_k > 80 AND stoch_14_3_3_k < stoch_14_3_3_d) OR
  close >= bollinger_20_upper OR
  close < ema_20

# Stop-Loss Conditions (ANY triggers immediate exit)
# 1. Price drops below EMA_50 (major trend break)
# 2. ATR-based trailing stop (2x ATR below entry)
# 3. Maximum loss threshold
# 4. RSI extreme oversold (< 25, panic selling)
stop_conditions: |
  close < ema_50 OR
  (close < entry_price - (2 * atr_14)) OR
  unrealized_pnl_pct < -0.04 OR
  rsi_14 < 25

# Position Sizing
# Smaller size due to infrequent but high-quality signals
position_sizing:
  type: "percentage"
  percentage_of_capital: 0.20  # 20% per trade (high confidence)
  max_position_size: 0.40      # Max 40% allocated across all positions

# Risk Management
risk_parameters:
  max_daily_loss: 0.025         # 2.5% daily loss limit
  max_drawdown: 0.12            # 12% max drawdown (conservative)
  stop_loss_percentage: 0.04    # 4% stop-loss
  take_profit_percentage: 0.12  # 12% take-profit (3:1 reward:risk)

# Strategy Characteristics:
# - Selectivity: HIGH (few signals, high quality)
# - Expected Win Rate: 60-70% (due to multiple confirmations)
# - Recommended Capital: $10,000+ (to handle infrequent signals)
# - Timeframe: 4h-1d (swing trading)
# - Market Conditions: Trending markets with pullbacks
# - Minimum Backtest Period: 3+ years
# - Paper Trading: 60+ days recommended
#
# Advanced Features Used:
# - Multi-indicator confluence
# - Lookback references (e.g., macd[1])
# - Composite conditions with AND/OR logic
# - ATR-based dynamic stops
# - Volume confirmation
